<!DOCTYPE html>

<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ„›çŸ¥çœŒä¸–å¸¯å¹´åãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</title>

```
<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />

<style>
    body {
        margin: 0;
        padding: 0;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    #map {
        height: 100vh;
        width: 100%;
    }
    
    .info {
        padding: 8px 12px;
        font: 14px/16px Arial, Helvetica, sans-serif;
        background: white;
        background: rgba(255,255,255,0.95);
        box-shadow: 0 0 15px rgba(0,0,0,0.2);
        border-radius: 8px;
        backdrop-filter: blur(10px);
    }
    
    .info h4 {
        margin: 0 0 8px;
        color: #333;
        font-size: 16px;
        font-weight: bold;
    }
    
    .legend {
        line-height: 20px;
        color: #555;
    }
    
    .legend i {
        width: 18px;
        height: 18px;
        float: left;
        margin-right: 8px;
        opacity: 0.9;
        border-radius: 3px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    }
    
    .info-details {
        margin-top: 10px;
        padding-top: 10px;
        border-top: 1px solid #ddd;
    }
    
    .info-details p {
        margin: 5px 0;
        font-size: 13px;
    }
    
    .loading {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 20px 40px;
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        z-index: 1000;
        font-size: 16px;
        color: #333;
    }
    
    .stats-panel {
        position: absolute;
        top: 10px;
        right: 10px;
        background: rgba(255,255,255,0.95);
        padding: 10px 15px;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        z-index: 1000;
        font-size: 12px;
    }
    
    .stats-panel h5 {
        margin: 0 0 5px 0;
        font-size: 14px;
    }
</style>
```

</head>
<body>
    <div id="loading" class="loading">åœ°å›³ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
    <div id="map"></div>
    <div class="stats-panel">
        <h5>ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆçµ±è¨ˆ</h5>
        <p id="dataPoints">è¨ˆç®—ä¸­...</p>
    </div>

```
<!-- Leaflet JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
<!-- Leaflet Heat -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>

<script>
    // æ„›çŸ¥çœŒã®è©³ç´°ãªåœ°åŸŸåˆ¥ä¸–å¸¯å¹´åãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãæ¨è¨ˆå€¤ï¼‰
    const detailedIncomeData = {
        // åå¤å±‹å¸‚ - åŒºã”ã¨ã«è©³ç´°åŒ–
        "åå¤å±‹å¸‚åƒç¨®åŒº": {
            income: 680,
            subAreas: {
                "æœ¬å±±": 720, "è¦šç‹å±±": 710, "æ±å±±": 700, "æ± ä¸‹": 670,
                "ä»Šæ± ": 650, "åƒç¨®": 660, "å¹ä¸Š": 640, "æ˜¥å²¡": 630
            }
        },
        "åå¤å±‹å¸‚æ±åŒº": {
            income: 650,
            subAreas: {
                "é«˜å²³": 680, "æ³‰": 670, "æ±æ¡œ": 660, "è‘µ": 640,
                "ä»£å®˜ç”º": 630, "ç™½å£": 690, "ä¸»ç¨ç”º": 650
            }
        },
        "åå¤å±‹å¸‚åŒ—åŒº": {
            income: 520,
            subAreas: {
                "é»’å·": 540, "å¤§æ›½æ ¹": 550, "å¹³å®‰": 510, "å¿—è³€": 500,
                "æ¥ ": 490, "å¦‚æ„": 480, "å‘³é‹º": 470
            }
        },
        "åå¤å±‹å¸‚è¥¿åŒº": {
            income: 540,
            subAreas: {
                "æµ„å¿ƒ": 560, "åº„å†…é€š": 550, "ä¸Šå°ç”°äº•": 540, "ä¸­å°ç”°äº•": 530,
                "æ „ç”Ÿ": 570, "åé§…è¥¿": 580, "æ‡æ·å³¶": 510
            }
        },
        "åå¤å±‹å¸‚ä¸­æ‘åŒº": {
            income: 510,
            subAreas: {
                "åé§…": 620, "å›½éš›ã‚»ãƒ³ã‚¿ãƒ¼": 600, "ä¸­æ‘å…¬åœ’": 480,
                "æœ¬é™£": 470, "äº€å³¶": 550, "å¤ªé–¤é€š": 520
            }
        },
        "åå¤å±‹å¸‚ä¸­åŒº": {
            income: 620,
            subAreas: {
                "æ „": 700, "ä¼è¦‹": 680, "ä¸¸ã®å†…": 670, "å¤§é ˆ": 580,
                "é‡‘å±±": 600, "é¶´èˆ": 590, "ä¸Šå‰æ´¥": 570
            }
        },
        "åå¤å±‹å¸‚æ˜­å’ŒåŒº": {
            income: 640,
            subAreas: {
                "å…«äº‹": 680, "ã„ã‚Šãªã‹": 660, "å·å": 650, "å¾¡å™¨æ‰€": 620,
                "æ¡œå±±": 630, "é¶´èˆ": 610, "å¹ä¸Š": 600
            }
        },
        "åå¤å±‹å¸‚ç‘ç©‚åŒº": {
            income: 630,
            subAreas: {
                "ç‘ç©‚é‹å‹•å ´": 650, "æ–°ç‘æ©‹": 640, "æ¡œå±±": 630,
                "ç‘ç©‚é€š": 620, "å €ç”°": 600, "å¦™éŸ³é€š": 610
            }
        },
        "åå¤å±‹å¸‚ç†±ç”°åŒº": {
            income: 550,
            subAreas: {
                "ç¥å®®å‰": 570, "é‡‘å±±": 580, "ç†±ç”°": 540, "æ—¥æ¯”é‡": 530,
                "å…­ç•ªç”º": 520, "ä¼é¦¬": 510
            }
        },
        "åå¤å±‹å¸‚ä¸­å·åŒº": {
            income: 480,
            subAreas: {
                "é«˜ç•‘": 500, "å…«ç”°": 490, "ä¸­å³¶": 470, "è’å­": 460,
                "å°¾é ­æ©‹": 510, "å±±ç‹": 480, "éœ²æ©‹": 450
            }
        },
        "åå¤å±‹å¸‚æ¸¯åŒº": {
            income: 460,
            subAreas: {
                "æ¸¯é™½": 480, "ç¯‰åœ°å£": 470, "æ±æµ·é€š": 460, "åæ¸¯": 450,
                "ç¨²æ°¸": 440, "é‡è·¡": 430, "å½“çŸ¥": 420
            }
        },
        "åå¤å±‹å¸‚å—åŒº": {
            income: 470,
            subAreas: {
                "ç¬ å¯º": 490, "æ–°ç‘æ©‹": 500, "é“å¾³": 460, "è±Šç”°": 450,
                "å¤§æ±Ÿ": 440, "æŸ´ç”°": 470, "é³´å°¾": 430
            }
        },
        "åå¤å±‹å¸‚å®ˆå±±åŒº": {
            income: 530,
            subAreas: {
                "å°å¹¡": 550, "å–œå¤šå±±": 540, "å¤§æ£®": 530, "ç“¢ç®ªå±±": 520,
                "å¿—æ®µå‘³": 510, "å‰æ ¹": 500, "ä¸Šå¿—æ®µå‘³": 490
            }
        },
        "åå¤å±‹å¸‚ç·‘åŒº": {
            income: 580,
            subAreas: {
                "å¾³é‡": 610, "å¹³æ‰‹": 600, "ç¥æ²¢": 590, "é³´æµ·": 570,
                "æœ‰æ¾": 560, "å¤§é«˜": 550, "å—å¤§é«˜": 540
            }
        },
        "åå¤å±‹å¸‚åæ±åŒº": {
            income: 660,
            subAreas: {
                "æ˜Ÿãƒ¶ä¸˜": 700, "ä¸€ç¤¾": 680, "ä¸Šç¤¾": 670, "æœ¬éƒ·": 650,
                "è—¤ãŒä¸˜": 690, "çŒªé«˜å°": 640, "æ¥µæ¥½": 630
            }
        },
        "åå¤å±‹å¸‚å¤©ç™½åŒº": {
            income: 590,
            subAreas: {
                "å…«äº‹": 620, "å¡©é‡œå£": 600, "æ¤ç”°": 590, "åŸ": 580,
                "å¹³é‡": 570, "é‡ä¸¦": 560, "ç›¸ç”Ÿå±±": 550
            }
        },
        
        // ä¸»è¦éƒ½å¸‚ã®è©³ç´°ãƒ‡ãƒ¼ã‚¿
        "è±Šæ©‹å¸‚": {
            income: 520,
            subAreas: {
                "è±Šæ©‹é§…å‰": 550, "å‘å±±": 540, "ç‰Ÿå‘‚": 530, "æ±ç”°": 510,
                "å‰ç”°": 500, "äºŒå·": 520, "å‰ç”°": 490
            }
        },
        "å²¡å´å¸‚": {
            income: 550,
            subAreas: {
                "åº·ç”Ÿ": 580, "å²¡å´é§…å‰": 570, "å…­å": 560, "çŸ¢ä½œ": 540,
                "ç¾åˆ": 530, "æœ¬å®¿": 520, "è—¤å·": 510
            }
        },
        "ä¸€å®®å¸‚": {
            income: 490,
            subAreas: {
                "ä¸€å®®é§…å‰": 520, "å°¾è¥¿": 480, "æœ¨æ›½å·": 470, "ä»Šä¼Šå‹¢": 490,
                "å¥¥ç”º": 500, "è©åŸ": 460, "åƒç§‹": 450
            }
        },
        "æ˜¥æ—¥äº•å¸‚": {
            income: 540,
            subAreas: {
                "å‹å·": 560, "æ˜¥æ—¥äº•é§…å‰": 550, "é«˜è”µå¯º": 530, "ç¥é ˜": 540,
                "å‘³ç¾": 520, "ç‰›å±±": 510, "é·¹æ¥": 500
            }
        },
        "è±Šç”°å¸‚": {
            income: 580,
            subAreas: {
                "è±Šç”°å¸‚é§…å‰": 610, "ä¸‰æ²³è±Šç”°": 590, "ä¸Šéƒ·": 570, "é«˜å²¡": 560,
                "çŒ¿æŠ•": 550, "ä¿è¦‹": 530, "è¶³åŠ©": 480, "ç¨²æ­¦": 450
            }
        },
        "åˆˆè°·å¸‚": {
            income: 620,
            subAreas: {
                "åˆˆè°·é§…å‰": 650, "åˆˆè°·å¸‚å½¹æ‰€": 630, "å¯Œå£«æ¾": 610, "æ±åˆˆè°·": 600,
                "é‡ç”°": 590, "ä¸€ãƒ„æœ¨": 580
            }
        },
        "å®‰åŸå¸‚": {
            income: 570,
            subAreas: {
                "å®‰åŸé§…å‰": 590, "ä¸‰æ²³å®‰åŸ": 600, "æ–°å®‰åŸ": 570, "æ¡œäº•": 550,
                "åŒ—å®‰åŸ": 540, "æ±åˆˆè°·": 560
            }
        },
        "å°ç‰§å¸‚": {
            income: 530,
            subAreas: {
                "å°ç‰§é§…å‰": 550, "å°ç‰§åŸ": 540, "å‘³å²¡": 530, "ç¯ å²¡": 510,
                "åŒ—é‡Œ": 500, "å—éƒ¨": 490
            }
        },
        "é•·ä¹…æ‰‹å¸‚": {
            income: 670,
            subAreas: {
                "è—¤ãŒä¸˜": 700, "ã¯ãªã¿ãšãé€š": 690, "æãƒ¶æ± ": 680,
                "é•·ä¹…æ‰‹å¤æˆ¦å ´": 660, "èŠ¸å¤§é€š": 650
            }
        },
        "æ—¥é€²å¸‚": {
            income: 620,
            subAreas: {
                "æ—¥é€²é§…å‰": 640, "èµ¤æ± ": 650, "ç±³é‡æœ¨": 610, "é¦™ä¹…å±±": 630,
                "å²©å´": 600, "äº”è‰²åœ’": 590
            }
        },
        "ã¿ã‚ˆã—å¸‚": {
            income: 640,
            subAreas: {
                "ä¸‰å¥½ãƒ¶ä¸˜": 670, "é»’ç¬¹": 650, "ç¦è°·": 630, "è‡ç”Ÿ": 620,
                "æ˜çŸ¥": 610
            }
        },
        "æ±æµ·å¸‚": {
            income: 540,
            subAreas: {
                "å¤ªç”°å·": 560, "å°¾å¼µæ¨ªé ˆè³€": 530, "é«˜æ¨ªé ˆè³€": 520,
                "åŠ æœ¨å±‹": 540, "å—åŠ æœ¨å±‹": 550
            }
        },
        "å¤§åºœå¸‚": {
            income: 580,
            subAreas: {
                "å¤§åºœé§…å‰": 600, "å…±å’Œ": 590, "å…±æ „": 570, "æ±æµ¦": 560,
                "åŒ—å´": 550
            }
        }
    };

    // ã‚ˆã‚Šç´°ã‹ã„åº§æ¨™ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
    const cityCoordinates = {
        // åå¤å±‹å¸‚å„åŒºã®åº§æ¨™
        "åå¤å±‹å¸‚åƒç¨®åŒº": [35.1667, 136.9467],
        "æœ¬å±±": [35.1620, 136.9650],
        "è¦šç‹å±±": [35.1580, 136.9550],
        "æ±å±±": [35.1560, 136.9720],
        "æ± ä¸‹": [35.1690, 136.9520],
        "ä»Šæ± ": [35.1650, 136.9380],
        "åƒç¨®": [35.1700, 136.9450],
        "å¹ä¸Š": [35.1600, 136.9420],
        "æ˜¥å²¡": [35.1750, 136.9550],
        
        "åå¤å±‹å¸‚æ±åŒº": [35.1783, 136.9267],
        "é«˜å²³": [35.1720, 136.9250],
        "æ³‰": [35.1750, 136.9180],
        "æ±æ¡œ": [35.1780, 136.9220],
        "è‘µ": [35.1810, 136.9290],
        "ä»£å®˜ç”º": [35.1830, 136.9320],
        "ç™½å£": [35.1850, 136.9280],
        "ä¸»ç¨ç”º": [35.1760, 136.9300],
        
        "åå¤å±‹å¸‚åŒ—åŒº": [35.1950, 136.9117],
        "é»’å·": [35.1880, 136.9100],
        "å¤§æ›½æ ¹": [35.1920, 136.9250],
        "å¹³å®‰": [35.1980, 136.9050],
        "å¿—è³€": [35.2000, 136.9200],
        "æ¥ ": [35.2050, 136.9150],
        "å¦‚æ„": [35.2100, 136.9100],
        "å‘³é‹º": [35.2150, 136.9000],
        
        "åå¤å±‹å¸‚è¥¿åŒº": [35.1900, 136.8900],
        "æµ„å¿ƒ": [35.1850, 136.8850],
        "åº„å†…é€š": [35.1920, 136.8780],
        "ä¸Šå°ç”°äº•": [35.2000, 136.8650],
        "ä¸­å°ç”°äº•": [35.1980, 136.8700],
        "æ „ç”Ÿ": [35.1780, 136.8850],
        "åé§…è¥¿": [35.1700, 136.8750],
        "æ‡æ·å³¶": [35.2020, 136.8550],
        
        "åå¤å±‹å¸‚ä¸­æ‘åŒº": [35.1650, 136.8733],
        "åé§…": [35.1700, 136.8820],
        "å›½éš›ã‚»ãƒ³ã‚¿ãƒ¼": [35.1680, 136.8900],
        "ä¸­æ‘å…¬åœ’": [35.1580, 136.8650],
        "æœ¬é™£": [35.1620, 136.8550],
        "äº€å³¶": [35.1720, 136.8780],
        "å¤ªé–¤é€š": [35.1600, 136.8700],
        
        "åå¤å±‹å¸‚ä¸­åŒº": [35.1686, 136.9109],
        "æ „": [35.1680, 136.9080],
        "ä¼è¦‹": [35.1700, 136.9000],
        "ä¸¸ã®å†…": [35.1750, 136.9050],
        "å¤§é ˆ": [35.1600, 136.9050],
        "é‡‘å±±": [35.1430, 136.9010],
        "é¶´èˆ": [35.1550, 136.9180],
        "ä¸Šå‰æ´¥": [35.1580, 136.9000],
        
        "åå¤å±‹å¸‚æ˜­å’ŒåŒº": [35.1500, 136.9333],
        "å…«äº‹": [35.1420, 136.9380],
        "ã„ã‚Šãªã‹": [35.1450, 136.9350],
        "å·å": [35.1480, 136.9280],
        "å¾¡å™¨æ‰€": [35.1520, 136.9250],
        "æ¡œå±±": [35.1420, 136.9200],
        "å¹ä¸Š": [35.1580, 136.9320],
        
        "åå¤å±‹å¸‚ç‘ç©‚åŒº": [35.1317, 136.9350],
        "ç‘ç©‚é‹å‹•å ´": [35.1280, 136.9380],
        "æ–°ç‘æ©‹": [35.1350, 136.9320],
        "ç‘ç©‚é€š": [35.1300, 136.9400],
        "å €ç”°": [35.1250, 136.9280],
        "å¦™éŸ³é€š": [35.1380, 136.9420],
        
        "åå¤å±‹å¸‚ç†±ç”°åŒº": [35.1283, 136.9100],
        "ç¥å®®å‰": [35.1250, 136.9080],
        "ç†±ç”°": [35.1300, 136.9050],
        "æ—¥æ¯”é‡": [35.1320, 136.9000],
        "å…­ç•ªç”º": [35.1200, 136.8950],
        "ä¼é¦¬": [35.1350, 136.9150],
        
        "åå¤å±‹å¸‚ä¸­å·åŒº": [35.1417, 136.8550],
        "é«˜ç•‘": [35.1380, 136.8600],
        "å…«ç”°": [35.1450, 136.8450],
        "ä¸­å³¶": [35.1350, 136.8400],
        "è’å­": [35.1500, 136.8500],
        "å°¾é ­æ©‹": [35.1480, 136.8700],
        "å±±ç‹": [35.1400, 136.8650],
        "éœ²æ©‹": [35.1300, 136.8550],
        
        "åå¤å±‹å¸‚æ¸¯åŒº": [35.1067, 136.8850],
        "æ¸¯é™½": [35.1100, 136.8900],
        "ç¯‰åœ°å£": [35.1050, 136.8950],
        "æ±æµ·é€š": [35.1000, 136.8800],
        "åæ¸¯": [35.0950, 136.8750],
        "ç¨²æ°¸": [35.0900, 136.8700],
        "é‡è·¡": [35.0850, 136.8650],
        "å½“çŸ¥": [35.1150, 136.8850],
        
        "åå¤å±‹å¸‚å—åŒº": [35.0950, 136.9317],
        "ç¬ å¯º": [35.0900, 136.9400],
        "é“å¾³": [35.1000, 136.9250],
        "è±Šç”°": [35.1050, 136.9200],
        "å¤§æ±Ÿ": [35.0850, 136.9150],
        "æŸ´ç”°": [35.0950, 136.9350],
        "é³´å°¾": [35.0800, 136.9450],
        
        "åå¤å±‹å¸‚å®ˆå±±åŒº": [35.2033, 136.9767],
        "å°å¹¡": [35.2000, 136.9700],
        "å–œå¤šå±±": [35.2050, 136.9650],
        "å¤§æ£®": [35.1950, 136.9800],
        "ç“¢ç®ªå±±": [35.2100, 136.9750],
        "å¿—æ®µå‘³": [35.2200, 136.9850],
        "å‰æ ¹": [35.2250, 136.9950],
        "ä¸Šå¿—æ®µå‘³": [35.2300, 137.0000],
        
        "åå¤å±‹å¸‚ç·‘åŒº": [35.0717, 136.9533],
        "å¾³é‡": [35.0650, 136.9600],
        "å¹³æ‰‹": [35.0700, 136.9650],
        "ç¥æ²¢": [35.0750, 136.9550],
        "é³´æµ·": [35.0800, 136.9500],
        "æœ‰æ¾": [35.0680, 136.9700],
        "å¤§é«˜": [35.0550, 136.9450],
        "å—å¤§é«˜": [35.0500, 136.9400],
        
        "åå¤å±‹å¸‚åæ±åŒº": [35.1767, 137.0100],
        "æ˜Ÿãƒ¶ä¸˜": [35.1650, 136.9850],
        "ä¸€ç¤¾": [35.1700, 136.9950],
        "ä¸Šç¤¾": [35.1750, 137.0050],
        "æœ¬éƒ·": [35.1800, 137.0150],
        "è—¤ãŒä¸˜": [35.1850, 137.0250],
        "çŒªé«˜å°": [35.1720, 137.0200],
        "æ¥µæ¥½": [35.1680, 137.0300],
        
        "åå¤å±‹å¸‚å¤©ç™½åŒº": [35.1233, 136.9750],
        "å¡©é‡œå£": [35.1300, 136.9800],
        "æ¤ç”°": [35.1250, 136.9850],
        "åŸ": [35.1200, 136.9900],
        "å¹³é‡": [35.1150, 136.9950],
        "é‡ä¸¦": [35.1100, 136.9700],
        "ç›¸ç”Ÿå±±": [35.1050, 136.9750],
        
        // ãã®ä»–ã®å¸‚ç”ºæ‘
        "è±Šæ©‹å¸‚": [34.7692, 137.3913],
        "å²¡å´å¸‚": [34.9544, 137.1744],
        "ä¸€å®®å¸‚": [35.3039, 136.8031],
        "ç€¬æˆ¸å¸‚": [35.2236, 137.0842],
        "åŠç”°å¸‚": [34.8923, 136.9373],
        "æ˜¥æ—¥äº•å¸‚": [35.2477, 136.9713],
        "è±Šå·å¸‚": [34.8272, 137.3757],
        "æ´¥å³¶å¸‚": [35.1770, 136.7412],
        "ç¢§å—å¸‚": [34.8861, 136.9914],
        "åˆˆè°·å¸‚": [35.0031, 137.0017],
        "è±Šç”°å¸‚": [35.0825, 137.1562],
        "å®‰åŸå¸‚": [34.9589, 137.0805],
        "è¥¿å°¾å¸‚": [34.8622, 137.0617],
        "è’²éƒ¡å¸‚": [34.8270, 137.2193],
        "çŠ¬å±±å¸‚": [35.3784, 136.9448],
        "å¸¸æ»‘å¸‚": [34.8876, 136.8316],
        "æ±Ÿå—å¸‚": [35.3320, 136.8706],
        "å°ç‰§å¸‚": [35.2911, 136.9116],
        "ç¨²æ²¢å¸‚": [35.2481, 136.7806],
        "æ–°åŸå¸‚": [34.9006, 137.4982],
        "æ±æµ·å¸‚": [35.0225, 136.9023],
        "å¤§åºœå¸‚": [35.0119, 136.9637],
        "çŸ¥å¤šå¸‚": [34.9950, 136.8644],
        "çŸ¥ç«‹å¸‚": [35.0014, 137.0502],
        "å°¾å¼µæ—­å¸‚": [35.2164, 137.0354],
        "é«˜æµœå¸‚": [34.9276, 136.9876],
        "å²©å€‰å¸‚": [35.2797, 136.8714],
        "è±Šæ˜å¸‚": [35.0536, 137.0130],
        "æ—¥é€²å¸‚": [35.1318, 137.0389],
        "ç”°åŸå¸‚": [34.6657, 137.2643],
        "æ„›è¥¿å¸‚": [35.1535, 136.7283],
        "æ¸…é ˆå¸‚": [35.2001, 136.8432],
        "åŒ—åå¤å±‹å¸‚": [35.2459, 136.8650],
        "å¼¥å¯Œå¸‚": [35.1113, 136.7244],
        "ã¿ã‚ˆã—å¸‚": [35.0894, 137.0744],
        "ã‚ã¾å¸‚": [35.1704, 136.8033],
        "é•·ä¹…æ‰‹å¸‚": [35.1843, 137.0487],
        "æ±éƒ·ç”º": [35.0970, 137.0507],
        "è±Šå±±ç”º": [35.2442, 136.9128],
        "å¤§å£ç”º": [35.3315, 136.9078],
        "æ‰¶æ¡‘ç”º": [35.3598, 136.9115],
        "å¤§æ²»ç”º": [35.1755, 136.8178],
        "èŸ¹æ±Ÿç”º": [35.1322, 136.7865],
        "é£›å³¶æ‘": [35.0892, 136.7925],
        "é˜¿ä¹…æ¯”ç”º": [34.9345, 136.9116],
        "æ±æµ¦ç”º": [34.9517, 136.9637],
        "å—çŸ¥å¤šç”º": [34.7194, 136.9281],
        "ç¾æµœç”º": [34.7772, 136.9067],
        "æ­¦è±Šç”º": [34.8510, 136.9145],
        "å¹¸ç”°ç”º": [34.8645, 137.1657],
        "è¨­æ¥½ç”º": [35.0974, 137.5725],
        "æ±æ „ç”º": [35.0765, 137.7004],
        "è±Šæ ¹æ‘": [35.1426, 137.7271]
    };

    // åœ°å›³ã®åˆæœŸåŒ–
    const map = L.map('map').setView([35.1804, 136.9065], 10);

    // OpenStreetMapã‚¿ã‚¤ãƒ«ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è¿½åŠ ï¼ˆæ¨™æº–çš„ãªåœ°å›³ï¼‰
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 19
    }).addTo(map);

    // ã‚«ãƒ©ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ã®å®šç¾©
    function getColor(income) {
        return income > 650 ? '#800026' :
               income > 600 ? '#BD0026' :
               income > 550 ? '#E31A1C' :
               income > 500 ? '#FC4E2A' :
               income > 480 ? '#FD8D3C' :
               income > 450 ? '#FEB24C' :
               income > 420 ? '#FED976' :
               income > 400 ? '#FFEDA0' :
                              '#FFFFCC';
    }

    // ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™ï¼ˆå¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆï¼‰
    const heatData = [];
    let totalDataPoints = 0;
    
    // è©³ç´°ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¤§é‡ã®ãƒã‚¤ãƒ³ãƒˆã‚’ç”Ÿæˆ
    for (const [city, data] of Object.entries(detailedIncomeData)) {
        if (typeof data === 'object' && data.subAreas) {
            // ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢
            if (cityCoordinates[city]) {
                const [lat, lng] = cityCoordinates[city];
                const intensity = data.income / 700;
                
                // ãƒ¡ã‚¤ãƒ³ãƒã‚¤ãƒ³ãƒˆ
                heatData.push([lat, lng, intensity]);
                totalDataPoints++;
                
                // ãƒ¡ã‚¤ãƒ³ã‚¨ãƒªã‚¢å‘¨è¾ºã«è¿½åŠ ãƒã‚¤ãƒ³ãƒˆï¼ˆ20å€‹ï¼‰
                for (let i = 0; i < 20; i++) {
                    const angle = (Math.PI * 2 * i) / 20;
                    const distance = 0.005 + Math.random() * 0.015;
                    const subLat = lat + Math.cos(angle) * distance;
                    const subLng = lng + Math.sin(angle) * distance;
                    const subIntensity = intensity * (0.8 + Math.random() * 0.2);
                    heatData.push([subLat, subLng, subIntensity]);
                    totalDataPoints++;
                }
            }
            
            // ã‚µãƒ–ã‚¨ãƒªã‚¢ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ
            for (const [subArea, subIncome] of Object.entries(data.subAreas)) {
                if (cityCoordinates[subArea]) {
                    const [subLat, subLng] = cityCoordinates[subArea];
                    const subIntensity = subIncome / 700;
                    
                    // ã‚µãƒ–ã‚¨ãƒªã‚¢ã®ãƒ¡ã‚¤ãƒ³ãƒã‚¤ãƒ³ãƒˆ
                    heatData.push([subLat, subLng, subIntensity]);
                    totalDataPoints++;
                    
                    // ã‚µãƒ–ã‚¨ãƒªã‚¢å‘¨è¾ºã«è¿½åŠ ãƒã‚¤ãƒ³ãƒˆï¼ˆ15å€‹ï¼‰
                    for (let j = 0; j < 15; j++) {
                        const angle = (Math.PI * 2 * j) / 15;
                        const distance = 0.003 + Math.random() * 0.01;
                        const pointLat = subLat + Math.cos(angle) * distance;
                        const pointLng = subLng + Math.sin(angle) * distance;
                        const pointIntensity = subIntensity * (0.85 + Math.random() * 0.15);
                        heatData.push([pointLat, pointLng, pointIntensity]);
                        totalDataPoints++;
                    }
                    
                    // ã‚ˆã‚Šç´°ã‹ã„ä¸­é–“ç‚¹ã‚’è¿½åŠ ï¼ˆ10å€‹ï¼‰
                    for (let k = 0; k < 10; k++) {
                        const randLat = subLat + (Math.random() - 0.5) * 0.02;
                        const randLng = subLng + (Math.random() - 0.5) * 0.02;
                        const randIntensity = subIntensity * (0.7 + Math.random() * 0.3);
                        heatData.push([randLat, randLng, randIntensity]);
                        totalDataPoints++;
                    }
                }
            }
        }
    }
    
    // ãã®ä»–ã®å¸‚ç”ºæ‘ã®ãƒ‡ãƒ¼ã‚¿ã‚‚è¿½åŠ 
    const simpleIncomeData = {
        "ç€¬æˆ¸å¸‚": 480, "åŠç”°å¸‚": 510, "è±Šå·å¸‚": 480,
        "æ´¥å³¶å¸‚": 440, "ç¢§å—å¸‚": 520, "è¥¿å°¾å¸‚": 490,
        "è’²éƒ¡å¸‚": 470, "çŠ¬å±±å¸‚": 510, "å¸¸æ»‘å¸‚": 480,
        "æ±Ÿå—å¸‚": 470, "ç¨²æ²¢å¸‚": 480, "æ–°åŸå¸‚": 430,
        "çŸ¥å¤šå¸‚": 520, "çŸ¥ç«‹å¸‚": 540, "å°¾å¼µæ—­å¸‚": 550,
        "é«˜æµœå¸‚": 510, "å²©å€‰å¸‚": 500, "è±Šæ˜å¸‚": 520,
        "ç”°åŸå¸‚": 480, "æ„›è¥¿å¸‚": 450, "æ¸…é ˆå¸‚": 510,
        "åŒ—åå¤å±‹å¸‚": 520, "å¼¥å¯Œå¸‚": 490, "ã‚ã¾å¸‚": 460,
        "æ±éƒ·ç”º": 590, "è±Šå±±ç”º": 520, "å¤§å£ç”º": 530,
        "æ‰¶æ¡‘ç”º": 490, "å¤§æ²»ç”º": 500, "èŸ¹æ±Ÿç”º": 490,
        "é£›å³¶æ‘": 550, "é˜¿ä¹…æ¯”ç”º": 510, "æ±æµ¦ç”º": 530,
        "å—çŸ¥å¤šç”º": 430, "ç¾æµœç”º": 440, "æ­¦è±Šç”º": 500,
        "å¹¸ç”°ç”º": 560, "è¨­æ¥½ç”º": 400, "æ±æ „ç”º": 380,
        "è±Šæ ¹æ‘": 390
    };
    
    for (const [city, income] of Object.entries(simpleIncomeData)) {
        if (cityCoordinates[city]) {
            const [lat, lng] = cityCoordinates[city];
            const intensity = income / 700;
            
            heatData.push([lat, lng, intensity]);
            totalDataPoints++;
            
            // å„å¸‚ç”ºæ‘ã«è¿½åŠ ãƒã‚¤ãƒ³ãƒˆï¼ˆ25å€‹ï¼‰
            for (let i = 0; i < 25; i++) {
                const angle = (Math.PI * 2 * i) / 25;
                const distance = 0.01 + Math.random() * 0.03;
                const subLat = lat + Math.cos(angle) * distance;
                const subLng = lng + Math.sin(angle) * distance;
                const subIntensity = intensity * (0.7 + Math.random() * 0.3);
                heatData.push([subLat, subLng, subIntensity]);
                totalDataPoints++;
            }
        }
    }

    // ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆæ•°ã‚’è¡¨ç¤º
    document.getElementById('dataPoints').textContent = `ç·ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ: ${totalDataPoints.toLocaleString()}å€‹`;

    // ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½œæˆ
    const heat = L.heatLayer(heatData, {
        radius: 20,
        blur: 15,
        maxZoom: 17,
        max: 1.0,
        gradient: {
            0.0: 'blue',
            0.2: 'cyan',
            0.4: 'lime',
            0.6: 'yellow',
            0.8: 'orange',
            1.0: 'red'
        }
    }).addTo(map);

    // ä¸»è¦ã‚¨ãƒªã‚¢ã«ãƒãƒ¼ã‚«ãƒ¼ã‚’è¿½åŠ 
    for (const [city, data] of Object.entries(detailedIncomeData)) {
        if (cityCoordinates[city] && typeof data === 'object') {
            const [lat, lng] = cityCoordinates[city];
            const marker = L.circleMarker([lat, lng], {
                radius: 8,
                fillColor: getColor(data.income),
                color: '#fff',
                weight: 2,
                opacity: 0.9,
                fillOpacity: 0.8
            }).addTo(map);
            
            let popupContent = `
                <div style="font-size: 14px; padding: 5px;">
                    <strong>${city}</strong><br>
                    å¹³å‡ä¸–å¸¯å¹´å: <span style="color: ${getColor(data.income)}; font-weight: bold;">
                        ${data.income}ä¸‡å††
                    </span>`;
            
            if (data.subAreas) {
                popupContent += `<br><br><strong>åœ°åŒºåˆ¥:</strong><br>`;
                for (const [subArea, subIncome] of Object.entries(data.subAreas)) {
                    popupContent += `${subArea}: ${subIncome}ä¸‡å††<br>`;
                }
            }
            
            popupContent += `</div>`;
            marker.bindPopup(popupContent);
        }
    }

    // æƒ…å ±ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®è¿½åŠ 
    const info = L.control();
    info.onAdd = function (map) {
        this._div = L.DomUtil.create('div', 'info');
        this.update();
        return this._div;
    };

    info.update = function () {
        this._div.innerHTML = '<h4>æ„›çŸ¥çœŒ ä¸–å¸¯å¹´åãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—</h4>' +
            '<div class="info-details">' +
            '<p><strong>ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºï¼š</strong></p>' +
            '<p>ğŸ”´ èµ¤è‰²: é«˜æ‰€å¾—åœ°åŸŸï¼ˆ600ä¸‡å††ä»¥ä¸Šï¼‰</p>' +
            '<p>ğŸŸ¡ é»„è‰²: ä¸­æ‰€å¾—åœ°åŸŸï¼ˆ500-600ä¸‡å††ï¼‰</p>' +
            '<p>ğŸ”µ é’è‰²: ä½æ‰€å¾—åœ°åŸŸï¼ˆ500ä¸‡å††æœªæº€ï¼‰</p>' +
            '<p style="margin-top: 10px; font-size: 11px; color: #666;">â€» ãƒãƒ¼ã‚«ãƒ¼ã‚’ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°è¡¨ç¤º<br>â€» ã‚ºãƒ¼ãƒ ã§è©³ç´°åº¦ãŒå¤‰åŒ–</p>' +
            '</div>';
    };

    info.addTo(map);

    // å‡¡ä¾‹ã®è¿½åŠ 
    const legend = L.control({position: 'bottomright'});
    legend.onAdd = function (map) {
        const div = L.DomUtil.create('div', 'info legend');
        const grades = [0, 400, 420, 450, 480, 500, 550, 600, 650];
        
        div.innerHTML = '<h4 style="margin-bottom: 10px;">ä¸–å¸¯å¹´åï¼ˆä¸‡å††ï¼‰</h4>';
        
        for (let i = 0; i < grades.length; i++) {
            div.innerHTML +=
                '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
                grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
        }
        
        return div;
    };
    legend.addTo(map);

    // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ç”»é¢ã‚’éè¡¨ç¤º
    setTimeout(() => {
        document.getElementById('loading').style.display = 'none';
    }, 1500);

    // ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã«å¿œã˜ã¦ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã®è¡¨ç¤ºã‚’èª¿æ•´
    map.on('zoomend', function() {
        const zoom = map.getZoom();
        if (zoom > 12) {
            heat.setOptions({radius: 10, blur: 8});
        } else if (zoom > 10) {
            heat.setOptions({radius: 15, blur: 12});
        } else {
            heat.setOptions({radius: 20, blur: 15});
        }
    });
</script>
```

</body>
</html>
